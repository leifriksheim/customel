import{html,render as lighterRender}from"lighterhtml";export default function Component({tag:t="my-element",mode:e="closed",props:s={},shadow:i=!0,autoDefine:h=!0,state:r={},actions:n={},mounted:o=(()=>{}),propChanged:p=(()=>{}),render:a=(()=>{}),styles:d=(()=>"")}){class c extends HTMLElement{constructor(){super(),this.props=s,this.propTypes={},this._initProps=this._initProps.bind(this),this.propChanged=p.bind(this),this._initProps(),this.state=r,this.setState=this.setState.bind(this),this.styles=d.bind(this),this.actions=n,this._initActions=this._initActions.bind(this),this._initActions(),this.engine=html.bind(this),this.html=a.bind(this),this.render=lighterRender.bind(this,i?this.attachShadow({mode:e}):this,this.render),this.mounted=o.bind(this),this.emit=this.emit.bind(this)}_initProps(){Object.keys(this.props).map(t=>{const e=typeOf(this.props[t]);this.propTypes[t]=e;const s=this.getAttribute(t)||this.hasAttribute(t)||this.props[t];this.props[t]=typeCast(s,e,t)})}_initActions(){Object.keys(this.actions).map(t=>{this.actions[t]=n[t].bind(this)})}_upradeProperty(t){let e=this[t];delete this[t],this[t]=e}static get observedAttributes(){return Object.keys(s).forEach(t=>{Object.defineProperty(this.prototype,t,{configurable:!0,get(){return this.props[t]},set(e){const s=this.props[t];this.props[t]=e,"object"==typeof e?this.render():null===e?this.removeAttribute(t):this.setAttribute(t,e),this.propChanged(t,s,e)}})}),Object.keys(s)}connectedCallback(){Object.keys(this.props).forEach(t=>{this._upradeProperty(t,this.prototype)}),this.render(),this.mounted()}attributeChangedCallback(t,e,s){const i=this.propTypes[t],h=this.props[t],r=typeCast(s||this.hasAttribute(t),i,t);h!==r&&(this.props[t]=r,this.render(),this.propChanged(t,h,r))}render(){return this.engine`
        <style>
        ${this.styles()}
        </style>
        ${this.html(this.engine)}
      `}setState(t){this.state={...this.state,...t},this.render()}emit(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e,bubbles:!1}))}}return h&&customElements.define(t,c),c};function typeCast(t,e,s){typeOf(t);return"boolean"===e?"true"===t:"number"===e?parseInt(t):"string"===e?String(t):t}function typeOf(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}