import{html,render as lighterRender}from"lighterhtml";export default function Component({tag:t="my-element",mode:s="closed",props:e={},shadow:i=!0,autoDefine:h=!0,state:r={},actions:n={},mounted:o=(()=>{}),propChanged:p=(()=>{}),render:a=(()=>{}),styles:d=(()=>"")}){class c extends HTMLElement{constructor(){super(),this.props=e,this.propTypes={},this._initProps=this._initProps.bind(this),this.propChanged=p.bind(this),this._initProps(),this.state=r,this.setState=this.setState.bind(this),this.styles=d.bind(this),this.actions=n,this._initActions=this._initActions.bind(this),this._initActions(),this.engine=html.bind(this),this.html=a.bind(this),this.render=lighterRender.bind(this,i?this.attachShadow({mode:s}):this,this.render),this.mounted=o.bind(this),this.emit=this.emit.bind(this)}_initProps(){Object.keys(this.props).map(t=>{const s=typeOf(this.props[t]);this.propTypes[t]=s;const e=this.getAttribute(t)||this.hasAttribute(t)||this.props[t];this.props[t]=typeCast(e,s)})}_initActions(){Object.keys(this.actions).map(t=>{this.actions[t]=n[t].bind(this)})}_upradeProperty(t){let s=this[t];delete this[t],this[t]=s}static get observedAttributes(){return Object.keys(e).forEach(t=>{Object.defineProperty(this.prototype,t,{configurable:!0,get(){return this.props[t]},set(s){const e=this.props[t];s!==e&&(this.props[t]=s,"object"!=typeof s&&(!1===s?this.removeAttribute(t):!0===s?this.setAttribute(t,""):this.setAttribute(t,s)),this.render(),this.propChanged(t,e,s))}})}),Object.keys(e)}connectedCallback(){Object.keys(this.props).forEach(t=>{this._upradeProperty(t)}),this.render(),this.mounted()}attributeChangedCallback(t,s,e){const i=this.props[t],h=typeCast(e||this.hasAttribute(t),this.propTypes[t]);i!==h&&(this[t]=h)}render(){return this.engine`
        <style>
        ${this.styles()}
        </style>
        ${this.html(this.engine)}
      `}setState(t){this.state={...this.state,...t},this.render()}emit(t,s){this.dispatchEvent(new CustomEvent(t,{detail:s,bubbles:!1}))}}return h&&customElements.define(t,c),c};function typeCast(t,s){return"boolean"===s?"true"===t||""===t||!0===t:"number"===s?parseInt(t):"string"===s?String(t):t}function typeOf(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}